<!-- pacientes.html - Versi贸n funcional + visual intacta -->
<section class="odc-pacientes-root">
  <div class="odc-topbar-green" aria-hidden="true"></div>
  <div class="odc-topbar-blue">
    <div class="odc-top-inner">
      <div class="odc-breadcrumbs">Pacientes</div>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="odc-pacientes-content">
    <div class="odc-controls">
      <div class="odc-controls-left">
        <button id="btnFiltroDoctor" class="odc-btn odc-btn-blue">Filtro por doctor</button>
        <button id="btnNuevoPaciente" class="odc-btn odc-btn-green">+ Nuevo paciente</button>
      </div>

      <div class="odc-controls-right">
        <input id="buscarPaciente" class="odc-search" placeholder="Buscar paciente por documento, nombre o tel茅fono..." aria-label="Buscar paciente"/>
        <button id="btnBuscar" class="odc-btn odc-btn-search">Buscar</button>
        <button id="btnInactivos" class="odc-btn odc-btn-inactive">Inactivos</button>
      </div>
    </div>

    <div class="odc-card tabla-card">
      <div class="tabla-wrap">
        <table class="odc-table">
          <thead>
            <tr>
              <th>Paciente</th>
              <th>Documento</th>
              <th>Fecha de ingreso</th>
              <th style="text-align:center">Acciones</th>
            </tr>
          </thead>
          <tbody id="tablaPacientes">
            <tr class="sin-datos"><td colspan="6">Sin datos</td></tr>
          </tbody>
        </table>
      </div>
      <div class="tabla-info">Resultados: <span id="resultCount">0</span></div>
    </div>
  </div>

  <!-- Modal: Formulario Nuevo Paciente -->
  <div id="modalPaciente" class="odc-modal" style="display:none">
    <div class="odc-modal-backdrop"></div>
    <div class="odc-modal-dialog odc-paciente-form">
      <div class="odc-modal-header">
        <h3>Nuevo paciente</h3>
        <button class="odc-modal-close" id="btnCerrarModal">&times;</button>
      </div>

      <!--  INICIO FORMULARIO PACIENTE -->
      <form id="formPaciente" class="odc-modal-body">
        <input type="hidden" id="pacienteId" />

        <!-- Campos ocultos para JS -->
        <input type="hidden" id="inputNombre" />
        <input type="hidden" id="inputDocumento" />
        <input type="hidden" id="inputTelefono" />
        <input type="hidden" id="inputEps" />
        <input type="hidden" id="inputDoctor" />

        <!-- FOTO DEL PACIENTE -->
        <div class="form-section">
          <label class="form-label">Foto del paciente</label>
          <div class="foto-upload">
            <input type="file" id="inputFoto" accept="image/*" class="form-input-file" />
            <div id="fotoPreviewContainer" class="foto-preview-container">
              <img id="fotoPreview" src="" alt="Vista previa" class="foto-preview" style="display:none;">
            </div>
            <div class="foto-hint">Arrastra o click para cargar la foto.</div>
          </div>
        </div>

        <!-- DATOS DE IDENTIFICACIN -->
        <h4 class="form-section-title">Datos de identificaci贸n</h4>
        <div class="form-grid">
          <div>
            <label>Tipo de documento *</label>
            <select id="tipoDocumento" class="form-input">
              <option value="">Seleccione...</option>
              <option>C茅dula</option>
              <option>Tarjeta de identidad</option>
              <option>Pasaporte</option>
              <option>Otro</option>
            </select>
          </div>
          <div>
            <label>Nro. de documento *</label>
            <input type="text" id="nroDocumento" class="form-input" placeholder="Nro. documento paciente" required />
          </div>
          <div>
            <label>N煤mero de Historia</label>
            <input type="text" id="nroHistoria" class="form-input" placeholder="Nro. historia paciente" />
          </div>
          <div>
            <label>Nombres *</label>
            <input type="text" id="nombres" class="form-input" placeholder="Nombres paciente" required />
          </div>
          <div>
            <label>Apellidos *</label>
            <input type="text" id="apellidos" class="form-input" placeholder="Apellidos paciente" required />
          </div>
          <div>
            <label>Nombre completo</label>
            <input type="text" id="nombreCompleto" class="form-input" placeholder="Nombre completo" readonly />
          </div>
          <div>
            <label>Sexo *</label>
            <select id="sexo" class="form-input" required>
              <option value="">Seleccione...</option>
              <option>Masculino</option>
              <option>Femenino</option>
              <option>Otro</option>
            </select>
          </div>
          <div>
            <label>Estado civil *</label>
            <select id="estadoCivil" class="form-input" required>
              <option value="">Seleccione...</option>
              <option>Soltero</option>
              <option>Casado</option>
              <option>Uni贸n libre</option>
              <option>Divorciado</option>
              <option>Viudo</option>
            </select>
          </div>
          <div>
            <label>Pa铆s de nacimiento *</label>
            <input type="text" id="paisNacimiento" class="form-input" placeholder="Ej: Colombia" />
          </div>
          <div>
            <label>Ciudad de nacimiento</label>
            <input type="text" id="ciudadNacimiento" class="form-input" />
          </div>
          <div>
            <label>Fecha de ingreso</label>
            <input type="text" id="fechaIngreso" class="form-input" readonly />
          </div>
          <div>
            <label>Fecha de nacimiento (dd/mm/aaaa) *</label>
            <input type="date" id="fechaNacimiento" class="form-input" required />
          </div>
          <div>
            <label>Edad</label>
            <input type="text" id="edad" class="form-input" readonly />
          </div>
          <div>
            <label>Pa铆s de domicilio *</label>
            <input type="text" id="paisDomicilio" class="form-input" required />
          </div>
          <div>
            <label>Ciudad de domicilio *</label>
            <input type="text" id="ciudadDomicilio" class="form-input" required />
          </div>
          <div>
            <label>Barrio de domicilio *</label>
            <input type="text" id="barrio" class="form-input" required />
          </div>
          <div>
            <label>Lugar de residencia *</label>
            <input type="text" id="lugarResidencia" class="form-input" required />
          </div>
          <div>
            <label>Estrato</label>
            <select id="estrato" class="form-input">
              <option value="">Seleccione...</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
            </select>
          </div>
          <div>
            <label>Zona residencial *</label>
            <select id="zonaResidencial" class="form-input" required>
              <option value="">Seleccione...</option>
              <option>Urbana</option>
              <option>Rural</option>
            </select>
          </div>
          <div><label>驴Es extranjero?</label><input type="checkbox" id="esExtranjero" /></div>
          <div><label>驴Permite recibir publicidad?</label><input type="checkbox" id="permitePublicidad" /></div>
        </div>

        <!-- CONTACTO -->
        <h4 class="form-section-title">Contacto</h4>
        <div class="form-grid">
          <div><label>Celular *</label><input id="celular" type="text" class="form-input" required /></div>
          <div><label>Tel茅fono de domicilio</label><input id="telDomicilio" type="text" class="form-input" /></div>
          <div><label>Tel茅fono de oficina</label><input id="telOficina" type="text" class="form-input" /></div>
          <div><label>Extensi贸n</label><input id="extension" type="text" class="form-input" /></div>
          <div><label>Correo electr贸nico *</label><input id="email" type="email" class="form-input" required /></div>
          <div><label>Ocupaci贸n *</label><input id="ocupacion" type="text" class="form-input" required /></div>
        </div>

        <!-- EPS -->
        <h4 class="form-section-title">EPS</h4>
        <div class="form-grid">
          <div><label>Tipo de vinculaci贸n *</label>
            <select id="tipoVinculacion" class="form-input" required>
              <option value="">Seleccione...</option>
              <option>Contributivo</option>
              <option>Subsidiado</option>
              <option>Particular</option>
              <option>Otro</option>
            </select>
          </div>
          <div><label>Nombre de la EPS *</label><input id="nombreEps" type="text" class="form-input" required /></div>
          <div><label>P贸liza de salud</label><input id="polizaSalud" type="text" class="form-input" /></div>
        </div>

        <!-- DOCTORES -->
        <h4 class="form-section-title">Doctores</h4>
        <div class="form-grid">
          <div><label>Doctor</label><input id="doctor" type="text" class="form-input" /></div>
        </div>

        <!-- BOTONES -->
        <div class="odc-modal-footer">
          <button type="button" id="modalCancel" class="btn-secundario">Cancelar</button>
          <button type="submit" class="btn-principal">Guardar paciente</button>
        </div>
      </form>
      <!--  FIN FORMULARIO PACIENTE -->
    </div>
  </div>

  <!-- Vista previa de imagen -->
  <script>
    document.getElementById("inputFoto").addEventListener("change", function (e) {
      const file = e.target.files[0];
      const preview = document.getElementById("fotoPreview");
      if (file) {
        const reader = new FileReader();
        reader.onload = function (ev) {
          preview.src = ev.target.result;
          preview.style.display = "block";
        };
        reader.readAsDataURL(file);
      }
    });

    // Sincronizar campos con IDs usados por el JS
    const sync = () => {
      const fullName = (nombres.value + " " + apellidos.value).trim();
      nombreCompleto.value = fullName;
      document.getElementById("inputNombre").value = fullName;
      document.getElementById("inputDocumento").value = nroDocumento.value;
      document.getElementById("inputTelefono").value = celular.value;
      document.getElementById("inputEps").value = nombreEps.value;
      document.getElementById("inputDoctor").value = doctor.value;
    };
    document.addEventListener("input", (e) => {
      if (["nombres","apellidos","nroDocumento","celular","nombreEps","doctor"].includes(e.target.id)) sync();
    });
  </script>

  <div id="doctorDropdown" class="odc-dropdown" aria-hidden="true">
    <div class="odc-dropdown-list">
      <div class="odc-dropdown-header">Filtrar por doctor</div>
      <div id="doctorList" class="odc-dropdown-items">
        <button class="odc-dropdown-item" data-doctor="__all">Todos</button>
      </div>
    </div>
  </div>
</section>

<link rel="stylesheet" href="modules/pacientes.css" />
